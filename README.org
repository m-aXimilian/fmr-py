#+title: Minimal FMR python-implementation
#+subtitle: with basic device support
#+author: Maximilian KÃ¼ffner

* Prerequisites
- Python3.# and pyvisa (~pip install pyvisa~)
- +NI-DAQmx Python API (~pip install nidaqmx~)+
- NI-DAQmx Pyhton API (~python -m pip install git+https://github.com/ni/nidaqmx-python.git~)[^fn-1]
- NIVisa
- pyyaml (~pip install pyyaml~)

[^fn-1]: ~Sequence~ moved from ~collections~ to ~collections.abc~ in Python 3.10 which yiedls include errors when using pip [[https://github.com/ni/nidaqmx-python/issues/129][nidaqmx issue 129]]

* Hints 
- make sure that ~pyvisa~ is aware of the NIVisa backend. If not, specify the path to the ~visa64.dll~ for the resource manager
- the path to the NIVisa backend can be set in a file called ~.pyvisarc~ (see [[https://pyvisa.readthedocs.io/en/latest/introduction/configuring.html][backend configuration]])
- see an example for reading and writing with an additional clock task at [[https://github.com/ni/nidaqmx-python/blob/master/nidaqmx/tests/test_read_write.py][nidaqmx tests]]


* Documentation
- [[https://pyvisa.readthedocs.io/en/latest/index.html][pyvisa man]]
- [[https://knowledge.ni.com/KnowledgeArticleDetails?id=kA00Z0000019Pf1SAE&l=de-DE][NI-DAQmx man]]
- [[https://github.com/ni/nidaqmx-python][nidaqmx python repo]]

* Measurement 

** DAQmx read and write values

** Continuous Read 
In order to allow for contiuous input streams, the main thread has to be kept busy
(i.e. by ~input()~ or ~sleep()~). If that is not done, the read task is terminated
before stream was read in!


* ToDo
- [x] config-files for devices
- [x] implement Measurement with a clock task
- [x] contiuous Measurement from multiple channels
- [ ] implement contiuous Measurement in the FMRMeasurement class (add callback and 
set the stream-reader entry point in the /start_measurement/ member function)
